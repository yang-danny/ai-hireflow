services:
   client:
      build:
         context: .
         dockerfile: packages/client/Dockerfile
      ports:
         - '5173:5173'
      environment:
         - NODE_ENV=production
      depends_on:
         - server

   server:
      build:
         context: .
         dockerfile: packages/server/Dockerfile
      ports:
         - '3000:3000'
      environment:
         - NODE_ENV=production
         - PORT=3000
         - MONGODB_URI=mongodb://mongo:27017/ai-hireflow
         - JWT_SECRET=docker-compose-secret-key
         - COOKIE_SECRET=docker-compose-cookie-secret
         - GOOGLE_CLIENT_ID=your-google-client-id
         - GOOGLE_CLIENT_SECRET=your-google-client-secret
         - FRONTEND_URL=http://localhost:3000
         - REDIS_URL=redis://redis:6379
      depends_on:
         - mongo
         - redis

   mongo:
      image: mongo:7
      ports:
         - '27017:27017'
      volumes:
         - mongo_data:/data/db

   redis:
      image: redis:7-alpine
      ports:
         - '6379:6379'
      volumes:
         - redis_data:/data

volumes:
   mongo_data:
   redis_data:
